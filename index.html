vou te mandar um html, e eu quero que me sugira melhorias ou implementa√ß√µes melhores. inclusive visuais ou mesmo de fontes.



<!DOCTYPE html>

<html lang="pt-BR">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Solicita√ß√£o de Folga - DERSO</title>



  <style>

    :root {

      --azul-principal: #007bff;

      --azul-escuro: #004d99;

      --erro: #dc3545;

      --sucesso: #28a745;

      --cinza-claro: #f7f7f7;

      --cinza-texto: #5a5a5a;

    }



    body {

      background-color: #ffffff;

      font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;

      color: #333;

      margin: 0;

      padding: 0;

      display: flex;

      justify-content: center;

      align-items: center;

      min-height: 100vh;

    }



    .container {

      width: 95%;

      max-width: 500px;

      background-color: var(--cinza-claro);

      border-radius: 12px;

      padding: 30px;

      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);

      box-sizing: border-box;

      display: flex;

      flex-direction: column;

      position: relative;

    }



    /* Barra de progresso */

    #progressBarContainer {

      position: absolute;

      top: 0;

      left: 0;

      width: 100%;

      height: 5px;

      background-color: #e0e0e0;

     border-radius: 8px 8px 0 0;

      overflow: hidden;

    }



    #progressBar {

     width: 0%;

      height: 100%;

      background-color: var(--azul-principal);

      transition: width 0.4s ease;

    }







    /* Logos */

    .logos {

      display: flex;

      justify-content: center;

      align-items: center;

      gap: 15px;

      margin-bottom: 15px;

    }





    .logos img {

      height: 70px;

      object-fit: contain;

    }







    h2, .subtitle {

      text-align: center;

      margin-bottom: 5px;

      line-height: 1.2;

    }







    h2 {

      color: var(--azul-escuro);

      font-size: 24px;

      font-weight: 600;

      margin-bottom: 5px;

    }







    .subtitle {

      color: var(--cinza-texto);

      font-size: 15px;

      margin-bottom: 25px;

    }







    .form-group, fieldset {

      margin-bottom: 20px;

      width: 100%;

      border: none;

      padding: 0;

    }







    label, legend {

      display: block;

      margin-bottom: 8px;

      color: #4a4a4a;

      font-weight: 500;

      font-size: 14px;

    }







    .form-group input:not([type="radio"]),

    .form-group select {

      width: 100%;

      padding: 12px 15px;

      font-size: 15px;

      border: 1px solid #ccc;

      border-radius: 8px;

      box-sizing: border-box;

      transition: border-color 0.3s ease, box-shadow 0.3s ease;

    }







    .form-group input:not([type="radio"]):focus,

    .form-group select:focus {

      border-color: var(--azul-principal);

      outline: none;

      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);

    }







    input[readonly] {

      background-color: #e9ecef;

      cursor: not-allowed;

    }







    input[id="matricula"]::placeholder {

      color: #aaa;

    }







  /* Novo CSS para os bot√µes de altern√¢ncia (Toggle Buttons) */

.radio-group-buttons {

  display: flex;

  flex-wrap: wrap;

  gap: 10px;

  margin-top: 10px;

}







.radio-group-buttons input[type="radio"] {

  /* Esconde o radio button nativo */

  display: none;

}







.radio-group-buttons label {



  /* Estiliza o label como um bot√£o */

  display: inline-block;

  padding: 8px 12px;

  border: 1px solid #ccc;

  border-radius: 6px;

  cursor: pointer;

  font-size: 14px;

  transition: background-color 0.2s, border-color 0.2s, color 0.2s;

  user-select: none;

  text-transform: uppercase; /* Para manter o estilo original das op√ß√µes */

}







.radio-group-buttons input[type="radio"]:checked + label {

  /* Estilo quando o bot√£o est√° selecionado */

  background-color: var(--azul-principal);

  color: #fff;

  border-color: var(--azul-principal);

  font-weight: 600;

  box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);

}







.radio-group-buttons label:hover {

  /* Estilo ao passar o mouse */

  background-color: var(--cinza-claro);

  border-color: var(--azul-principal);

}







/* Garante que em telas pequenas as op√ß√µes continuem organizadas */

@media (max-width: 576px) {

  /* Ajuste para que as op√ß√µes continuem em linha, se houver espa√ßo, ou quebrem */

  .radio-group-buttons {

    justify-content: center; /* Centraliza no m√≥vel */

  }



}







    /* Feedback visual para campos */

.form-group input.is-valid {

  border-color: var(--sucesso) !important;

  box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2) !important; /* Cor de sucesso */

}







.form-group input.is-invalid {

  border-color: var(--erro) !important;

  box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important; /* Cor de erro */

}







    .button {

      background-color: var(--azul-principal);

      color: #fff;

      border: none;

      cursor: pointer;

      padding: 14px 20px;

      font-size: 16px;

      font-weight: 600;

      border-radius: 8px;

      transition: background-color 0.3s ease, transform 0.2s ease;

      display: block;

      width: 100%;

      box-sizing: border-box;

    }







    .button:hover {

      background-color: #0056b3;

      transform: translateY(-2px);

    }







    .button:active {

      transform: translateY(0);

    }







    .error {

      color: var(--erro);

     margin-top: 5px;

      font-size: 12px;

      font-weight: 500;

    }







    .required-star {

      color: var(--erro);

      margin-left: 2px;

    }







    .info-message {

      text-align: center;

      padding: 10px;

      border-radius: 8px;

      font-size: 14px;

      display: none;

    }







    .info-message.success {

     background-color: #d4edda;

      color: #155724;

    }







    .info-message.error {

      background-color: #f8d7da;

      color: #721c24;

    }







    .footer {

      text-align: center;

      margin-top: 25px;

      font-size: 12px;

      color: #5a5a5a;

    }







    @media (max-width: 576px) {

      .container { padding: 20px; }

      h2 { font-size: 20px; }

      .subtitle { font-size: 13px; }

      .form-group input:not([type="radio"]), .form-group select { font-size: 14px; }

      .button { font-size: 14px; padding: 12px 15px; }

      .radio-group { flex-direction: column; gap: 10px; }

      .logos img { height: 50px; }

    }



  </style>

</head>

<body>

  <div class="container" id="formulario">

    <div id="progressBarContainer"><div id="progressBar"></div></div>

    <div class="logos">

      <img src="https://rondonia.ro.gov.br/wp-content/uploads/2024/09/Brasao-PMRO-370x523.png" alt="PMRO">

      <img src="https://museu.pm.ro.gov.br/wp-content/uploads/2024/05/1-bpm-3.png" alt="1¬∫ BPM">

    </div>



    <h2>DERSO 1¬∫ BPM</h2>

    <p class="subtitle">Formul√°rio de Solicita√ß√£o de Folga</p>



    <form id="dersoForm" style="display: none;">

      <div class="form-group">

       <label for="email">E-mail:</label>

        <input type="email" id="email" name="email" list="emailProviders" required autofocus>

        <datalist id="emailProviders"></datalist>

      </div>



     <div class="form-group">

        <label for="matricula">Matr√≠cula:</label>

        <input type="text" id="matricula" name="matricula" required placeholder="Ex: 12345 ou 100012345">

        <div id="matriculaError" class="error"></div>

      </div>





     <div class="form-group">

  <label for="nome">Nome:</label>

  <input type="text" id="nome" name="nome" readonly required>

</div>







<fieldset>



  <legend>Tipo de Folga<span class="required-star">*</span>:</legend>

  <div class="radio-group-buttons">

    <input type="radio" id="folga24H" name="folga" value="24H" required><label for="folga24H">24H</label>

    <input type="radio" id="folga48H" name="folga" value="48H"><label for="folga48H">48H</label>

    <input type="radio" id="folga72H" name="folga" value="72H"><label for="folga72H">72H</label>

    <input type="radio" id="folga96H" name="folga" value="96H"><label for="folga96H">96H</label>

    <input type="radio" id="folgaLE" name="folga" value="FOLGA LE"><label for="folgaLE">FOLGA LE</label>

    <input type="radio" id="folga1" name="folga" value="1¬™ Folga"><label for="folga1">1¬™ FOLGA</label>

    <input type="radio" id="folga2" name="folga" value="2¬™ Folga"><label for="folga2">2¬™ FOLGA</label>

    <input type="radio" id="folgaExp" name="folga" value="Expediente"><label for="folgaExp">EXPEDIENTE</label>

  </div>



  <div id="duplicateError" class="error"></div>



</fieldset>





    <div class="form-group">

  <label for="data">Data:</label>

  <input type="date" id="data" name="data" required>

  <div id="dateLimitMessage" class="subtitle" style="margin-top: 5px; margin-bottom: 0; font-size: 12px; text-align: left;"></div>

</div>



      <button type="submit" class="button">Enviar Solicita√ß√£o</button>

    </form>

    <div id="statusMessage" class="info-message"></div>

    <div class="footer" id="footerText"></div>

  </div>



 <script>

    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwe2vseE23YEgIwPxOHiXlv3COUfJYVRsMSTYov0v78zSgDZtOeTCYx1J8GOzlzKhwDFg/exec";

    const emailProviders = ["gmail.com","hotmail.com","outlook.com","yahoo.com","terra.com.br","bol.com.br"];

    window.employeeList = {};



    const progressBar = document.getElementById("progressBar");

    const formDiv = document.getElementById("dersoForm");



    function setProgress(percent) {

      progressBar.style.width = percent + "%";

    }



    function updateEmailDatalist() {

      const emailInput = document.getElementById("email");

      const datalist = document.getElementById("emailProviders");

      const value = emailInput.value;

      const atIndex = value.indexOf("@");

      if (atIndex === -1) { datalist.innerHTML = ""; return; }

      const domainPart = value.slice(atIndex + 1).toLowerCase();

      const filtered = emailProviders.filter(p => p.startsWith(domainPart));

      datalist.innerHTML = "";

      filtered.forEach(p => { const option = document.createElement("option"); option.value = value.slice(0, atIndex+1)+p; datalist.appendChild(option); });

    }



    function standardizeMatricula(m) {

      let num = m.replace(/\D/g,'').slice(0,9);

      return num.startsWith("1000") ? num : "1000"+num;

    }



    // Fun√ß√£o de Checagem de Duplicidade (Async)

    async function checkDuplicity(matricula, data, folga) {

        // O SCRIPT_URL precisa estar configurado para aceitar a a√ß√£o 'check_duplicidade'

        const url = `${SCRIPT_URL}?action=check_duplicidade&matricula=${matricula}&data=${data}&folga=${folga}`;

        try {

          const response = await fetch(url);

          const dataJson = await response.json();

          // Verifica se a resposta cont√©m a flag de duplicidade

          return dataJson.duplicado === true; 

        } catch (e) {

          // Em caso de falha na checagem, assume que N√ÉO √â duplicado, mas avisa

          console.error("Falha ao verificar duplicidade:", e);

          showMessage("‚ö†Ô∏è Erro ao verificar duplicidade. Tentando enviar...", "error");

          return false; // Permite o envio para evitar bloqueio indevido

        }

    }



    function loadEmployeeList() {

        setProgress(20);

        const matriculaInput = document.getElementById("matricula");

        matriculaInput.disabled = true; 

        matriculaInput.placeholder = "Carregando lista de funcion√°rios...";



        fetch(SCRIPT_URL+"?action=lista")

        .then(r => r.json())

        .then(data => {

            if(data.error) throw new Error(data.error);

            window.employeeList = data;

            setProgress(40);

            matriculaInput.disabled = false; 

            matriculaInput.placeholder = "Ex: 12345 ou 100012345";

        }).catch(()=>{

            document.getElementById("matriculaError").textContent="Erro ao carregar lista de funcion√°rios.";

            showPersistentMessage("‚ö†Ô∏è Erro grave ao carregar dados de funcion√°rios. Tente recarregar a p√°gina.", "error");

            formDiv.style.display = "none";

        });

    }



   function checkMatricula() {

        const m = document.getElementById("matricula");

        const n = document.getElementById("nome");

        const e = document.getElementById("matriculaError");

        const standardized = standardizeMatricula(m.value);

  

        m.classList.remove("is-valid", "is-invalid");



        m.value = standardized;

        if(window.employeeList[standardized]) { 

            n.value = window.employeeList[standardized]; 

            e.textContent = ""; 

            m.classList.add("is-valid"); 

        }

        else { 

            n.value = ""; 

            e.textContent = "Matr√≠cula n√£o encontrada!"; 

            m.classList.add("is-invalid"); 

        }

    }



    function setDateLimits() {

        const dateInput = document.getElementById("data");

        const messageDiv = document.getElementById("dateLimitMessage"); 



        const today = new Date();

        let nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);

        let nextMonthEnd = new Date(today.getFullYear(), today.getMonth() + 2, 0);



        dateInput.min = nextMonthStart.toISOString().split("T")[0];

        dateInput.max = nextMonthEnd.toISOString().split("T")[0];



        const startDay = nextMonthStart.getDate().toString().padStart(2, '0');

        const startMonth = (nextMonthStart.getMonth() + 1).toString().padStart(2, '0');

        const endDay = nextMonthEnd.getDate().toString().padStart(2, '0');

        const endMonth = (nextMonthEnd.getMonth() + 1).toString().padStart(2, '0');



        messageDiv.textContent = `Per√≠odo de folga permitido: ${startDay}/${startMonth} a ${endDay}/${endMonth}.`;

    }



    function formatDateBR(d) {

      if(!d) return "";

      const [y,m,day] = d.split("-");

      return `${day}/${m}/${y}`;

    }



    // Fun√ß√£o de Submiss√£o Atualizada com Checagem de Duplicidade (Async)

    async function submitForm(e){

      e.preventDefault();

      const form = document.getElementById("dersoForm");

      const btn = document.querySelector(".button");

      const matriculaInput = document.getElementById("matricula");

      const dataValue = document.getElementById("data").value;

      const folgaRadio = document.querySelector('input[name="folga"]:checked');

      const duplicateError = document.getElementById("duplicateError");

      const nomeValue = document.getElementById("nome").value.trim();

      const dataBR = formatDateBR(dataValue);



      duplicateError.textContent = "";

      

      // Valida√ß√µes b√°sicas

      if(!folgaRadio){

        duplicateError.textContent = "Selecione um Tipo de Folga."; 

        return;

      }

      if(nomeValue === "" || matriculaInput.classList.contains("is-invalid")){

        document.getElementById("matriculaError").textContent = nomeValue === "" ? "Matr√≠cula inv√°lida. Verifique o n√∫mero." : "Matr√≠cula inv√°lida."; 

        return;

      }



      btn.disabled = true;

      setProgress(60);



      try {

          // 1. VERIFICA√á√ÉO DE DUPLICIDADE

          const isDuplicate = await checkDuplicity(

            matriculaInput.value, 

            dataBR, 

            folgaRadio.value

          );



          if (isDuplicate) {

            showMessage(`‚ö†Ô∏è Solicita√ß√£o DUPLICADA. Voc√™ j√° solicitou **${folgaRadio.value}** para ${dataBR}.`, "error");

            return; // Para a submiss√£o

          }

          

          // 2. ENVIO FINAL

          const fd = new FormData(form);

          fd.set("data", dataBR);

          fd.set("folga", folgaRadio.value); // Garante que a folga checada √© a que √© enviada



          const response = await fetch(SCRIPT_URL, {method: "POST", body: new URLSearchParams(fd)});

          const data = await response.json();



          if(data.success){

            showMessage("‚úÖ Solicita√ß√£o enviada com sucesso! Um resumo foi enviado para o seu e-mail.","success"); 

            form.reset(); 

          } else {

            showMessage("‚ö†Ô∏è "+(data.error||"Erro ao enviar. Tente novamente."),"error");

          }



      } catch(error) {

        console.error("Erro na duplicidade ou envio:", error);

        showMessage("‚ö†Ô∏è Falha na conex√£o ou processamento. Tente novamente.", "error");

      } finally {

        btn.disabled = false;

        setProgress(100);

        setTimeout(()=>setProgress(0), 1500);

      }

    }



  // Fun√ß√£o para mostrar mensagens tempor√°rias (sucesso/erro do submit)

function showMessage(msg, type = "success") {

  const div = document.getElementById("statusMessage");

  div.className = "info-message " + type;

  div.innerHTML = msg; // Usamos innerHTML para suportar negrito/emojis

  div.style.display = "block";

  // A mensagem TEMPOR√ÅRIA √© oculta ap√≥s 5 segundos

  setTimeout(() => { div.style.display = "none"; }, 5000); 

}



// Fun√ß√£o para mostrar a mensagem de PRAZO (deve ser persistente)

function showPersistentMessage(msg, type = "success") {

  const div = document.getElementById("statusMessage");

  div.className = "info-message " + type;

  div.innerHTML = msg;

  div.style.display = "block";

  // A mensagem PERSISTENTE n√£o √© oculta.

}  

    

 function initializeForm(){

  loadEmployeeList();

  setDateLimits();

  const footer = document.getElementById("footerText"); 



  fetch(SCRIPT_URL+"?action=datas")

  .then(r=>r.json())

  .then(data=>{

      if(data.error) {

          showPersistentMessage(`‚ö†Ô∏è Erro ao verificar o prazo: ${data.error}`, "error");

          formDiv.style.display = "none"; 

          return;

      }

      

      const agora = new Date();

      const abertura = new Date(data.abertura);

      const fechamento = new Date(data.fechamento);



      if(agora < abertura || agora > fechamento){

        // Per√≠odo Fechado

        const msg = agora < abertura

            ? `‚è≥ **Abertura:** ${abertura.toLocaleString("pt-BR")}`

            : `‚õî **Encerrado:** ${fechamento.toLocaleString("pt-BR")}`;

        

        showPersistentMessage(msg, "error");

        formDiv.style.display = "none"; 

      } else {

        // Per√≠odo Aberto: Mostra o formul√°rio e o tempo restante

        formDiv.style.display = "block";

        

        const diffTime = fechamento.getTime() - agora.getTime();

        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

        

        const msg = `üö® **Aten√ß√£o!** Restam **${diffDays} dia(s)** para o fechamento do formul√°rio em ${fechamento.toLocaleDateString("pt-BR")} √†s ${fechamento.toLocaleTimeString("pt-BR")}.`;



        showPersistentMessage(msg, "success");

      }

  })

  .catch(error => {

    // Falha geral na comunica√ß√£o com o script de datas

    showPersistentMessage(`‚ö†Ô∏è Falha ao conectar com o servidor. Verifique o link do script.`, "error");

    formDiv.style.display = "none";

  });





  const now = new Date();

  const mes = now.getMonth()+1; const ano = now.getFullYear();

  footer.textContent=`Desenvolvido na 1¬™ Cia do 1¬∫ BPM pelo PVSA Pedro Porto - ${mes.toString().padStart(2,'0')}/${ano}`;

}

    

    document.addEventListener("DOMContentLoaded",()=>{

      initializeForm();

      document.getElementById("matricula").addEventListener("blur",checkMatricula);

      document.getElementById("email").addEventListener("input",updateEmailDatalist);

      document.getElementById("dersoForm").addEventListener("submit",submitForm);

    });

  </script>

</body>

</html>
